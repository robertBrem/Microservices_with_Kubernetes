<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Create an Angular 2 frontend - Microservices with Kubernetes</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Create an Angular 2 frontend";
    var mkdocs_page_input_path = "15_Angular2_frontend/01_Initial_setup.md";
    var mkdocs_page_url = "/15_Angular2_frontend/01_Initial_setup/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Microservices with Kubernetes</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Microservices with Kubernetes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../README/">Microservices with Kubernetes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">01 Setup</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../01_Setup/01_Host_setup/">Setup your local host machine</a>
                </li>
                <li class="">
                    
    <a class="" href="../../01_Setup/02_Kubernetes_setup/">Setup a Kubernetes cluster</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">02 First rest service</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../02_First_rest_service/01_JavaEE_service/">Creating our first JavaEE microservice</a>
                </li>
                <li class="">
                    
    <a class="" href="../../02_First_rest_service/02_Dockerization/">Dockerization of the service</a>
                </li>
                <li class="">
                    
    <a class="" href="../../02_First_rest_service/03_Deploy_in_Kubernetes/">Deploy the Docker image of the service in Kubernetes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">03 Docker registry</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../03_Docker_registry/01_Setup_a_docker_registry/">Setup a docker registry</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">04 Jenkins</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../04_Jenkins/01_Setup_Jenkins_in_Kubernetes/">Setup Jenkins in Kubernetes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">05 Build and push ci step</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../05_Build_and_push_ci_step/01_Build_and_push_CI_step/">Build and push CI step</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">06 Systemtest ci step</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../06_Systemtest_ci_step/01_Setup_test_env/">Setup the test environment</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06_Systemtest_ci_step/02_Systemtest/">Add a system test</a>
                </li>
                <li class="">
                    
    <a class="" href="../../06_Systemtest_ci_step/03_Start_pipeline_on_every_push/">Start the Jenkins pipeline on every push</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">07 UI test</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../07_UI_test/01_UI_Test/">UI Test</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">08 Lasttest</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../08_Lasttest/01_Last_test/">Last test</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">09 Manual test</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../09_Manual_test/01_Create_manual_test/">Create manual test</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">10 Canary release</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../10_Canary_release/01_Create_a_canary_release/">Create a canary release</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">11 Full production release</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../11_Full_production_release/01_Go_full_production/">Go full production with the new version</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">12 Own Gogs</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../12_Own_Gogs/01_Use_your_own_Git_repository/">Use your own Git repository</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">13 Monitoring</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../13_Monitoring/01_Dashboard/">Kubernetes dashboard</a>
                </li>
                <li class="">
                    
    <a class="" href="../../13_Monitoring/02_Prometheus/">Monitoring with Prometheus</a>
                </li>
                <li class="">
                    
    <a class="" href="../../13_Monitoring/03_Weave_scope/">Weave Scope</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">14 Documentation of rest service</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../14_Documentation_of_rest_service/01_Documentation/">Documentation of the `jax-rs` service</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">15 Angular2 frontend</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="./">Create an Angular 2 frontend</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#create-an-angular-2-frontend">Create an Angular 2 frontend</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#install-nodejs-and-npm">Install NodeJS and NPM</a></li>
        
            <li><a class="toctree-l4" href="#setup-the-angular-2-project">Setup the Angular 2 project</a></li>
        
            <li><a class="toctree-l4" href="#create-a-docker-image">Create a Docker image</a></li>
        
            <li><a class="toctree-l4" href="#create-the-jenkins-pipeline">Create the Jenkins pipeline</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../02_Test_and_prod_stage/">02 Test and prod stage</a>
                </li>
                <li class="">
                    
    <a class="" href="../03_First_view/">03 First view</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">16 SSO with Keycloak</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../16_SSO_with_Keycloak/01_Setup_Keycloak/">01 Setup Keycloak</a>
                </li>
                <li class="">
                    
    <a class="" href="../../16_SSO_with_Keycloak/02_Initial_setup_of_Keycloak/">02 Initial setup of Keycloak</a>
                </li>
                <li class="">
                    
    <a class="" href="../../16_SSO_with_Keycloak/03_Secure_REST_service/">03 Secure REST service</a>
                </li>
                <li class="">
                    
    <a class="" href="../../16_SSO_with_Keycloak/04_Secure_frontend_service/">04 Secure frontend service</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">17 Event Sourcing with Cassandra</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../17_Event_Sourcing_with_Cassandra/01_Setup_Cassandra/">01 Setup Cassandra</a>
                </li>
                <li class="">
                    
    <a class="" href="../../17_Event_Sourcing_with_Cassandra/02_REST_service_with_event_sourcing/">02 REST service with event sourcing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../17_Event_Sourcing_with_Cassandra/03_Changes_to_the_frontend/">03 Changes to the frontend</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">18 Connect keycloak user with application user</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../18_Connect_keycloak_user_with_application_user/01_Setup_keycloak_with_a_provider/">01 Setup keycloak with a provider</a>
                </li>
                <li class="">
                    
    <a class="" href="../../18_Connect_keycloak_user_with_application_user/02_Changes_to_the_REST_service/">02 Changes to the REST service</a>
                </li>
                <li class="">
                    
    <a class="" href="../../18_Connect_keycloak_user_with_application_user/03_Changes_in_the_environment/">03 Changes in the environment</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">19 CQRS with Kafka</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../19_CQRS_with_Kafka/01_Setup_Kafka/">01 Setup Kafka</a>
                </li>
                <li class="">
                    
    <a class="" href="../../19_CQRS_with_Kafka/02_Command_service/">02 Command service</a>
                </li>
                <li class="">
                    
    <a class="" href="../../19_CQRS_with_Kafka/03_Query_service/">03 Query service</a>
                </li>
                <li class="">
                    
    <a class="" href="../../19_CQRS_with_Kafka/04_Frontend_service/">04 Frontend service</a>
                </li>
                <li class="">
                    
    <a class="" href="../../19_CQRS_with_Kafka/05_Other_updates/">05 Other updates</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">20 Fileuploader</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../20_Fileuploader/01_Create_fileuploader_service/">01 Create fileuploader service</a>
                </li>
                <li class="">
                    
    <a class="" href="../../20_Fileuploader/02_REST_service_adaptions/">02 REST service adaptions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../20_Fileuploader/03_Query_service_adaptions/">03 Query service adaptions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../20_Fileuploader/04_Frontend_adaptions/">04 Frontend adaptions</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Microservices with Kubernetes</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>15 Angular2 frontend &raquo;</li>
        
      
    
    <li>Create an Angular 2 frontend</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/robertBrem/Microservices_with_Kubernetes/edit/master/docs/15_Angular2_frontend/01_Initial_setup.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="create-an-angular-2-frontend">Create an Angular 2 frontend</h1>
<h2 id="install-nodejs-and-npm">Install NodeJS and NPM</h2>
<p>We're going to use NPM as our package manager. To install NodeJS and NPM execute the
following command:</p>
<pre><code>curl -sL https://deb.nodesource.com/setup_7.x | sudo -E bash -
sudo apt-get install -y nodejs
</code></pre>

<h2 id="setup-the-angular-2-project">Setup the Angular 2 project</h2>
<p>We are using a bootstrap project to get started with Angular 2:</p>
<pre><code>git clone --depth 1 https://github.com/angularclass/angular2-webpack-starter.git
cd angular2-webpack-starter
npm install
npm run server:dev:hmr
</code></pre>

<p>Now you can open the frontend on this url:</p>
<pre><code>http://localhost:3000
</code></pre>

<h2 id="create-a-docker-image">Create a Docker image</h2>
<p>If there isn't already a <code>Dockerfile</code> in the mail folder, create one with
the following settings:</p>
<pre><code>FROM nginx:latest

MAINTAINER Robert Brem &lt;brem_robert@hotmail.com&gt;

ADD dist/ /usr/share/nginx/html
</code></pre>

<p>Like the <code>jax-rs</code> service the Angular2 service needs a <code>build.js</code> script
to create and push the Docker image in the repository.</p>
<pre><code>#!/usr/bin/jjs -fv

var version = $ENV.VERSION;
var username = $ENV.REGISTRY_USERNAME;
var password = $ENV.REGISTRY_PASSWORD;
var email = $ENV.REGISTRY_EMAIL;

var registry = &quot;disruptor.ninja:30500&quot;;
var imageName = registry + &quot;/robertbrem/battleapp-frontend:&quot; + version;

var build = &quot;docker build -t &quot; + imageName + &quot; .&quot;;
execute(build);

var dockerLogin = &quot;docker login --username=&quot; + username + &quot; --password=&quot; + password + &quot; --email=&quot; + email + &quot; &quot; + registry;
execute(dockerLogin);

var push = &quot;docker push &quot; + imageName;
execute(push);

function execute(command) {
  $EXEC(command);
  print($OUT);
  print($ERR);
}
</code></pre>

<h2 id="create-the-jenkins-pipeline">Create the Jenkins pipeline</h2>
<p>First of all we've to install NodeJS and NPM on Jenkins.</p>
<p>On Jenkins go to <code>Manage Jenkins</code> <code>Manage Plugins</code>. Change to the 
<code>Available</code> tab and search for the <code>NodeJS Plugin</code> and install it.</p>
<p>After the restart go to <code>Manage Jenkins</code> <code>Global Tool Configuration</code>.<br />
Under the title <code>NodeJS</code> we make the following settings:</p>
<p><img alt="Install NodeJS" src="../images/install_nodejs.png" /></p>
<p>This installs NodeJS and NPM and we can use it in our pipeline.</p>
<p>The Angular2 sample project also allows us to statically analyze our code and
compares it with the official Angular2 style guide. We can include this
analysis in our pipeline with the <code>Checkstyle</code> plugin. Just search under
<code>Avaialble</code> plugins for <code>Checkstyle Plug-in</code> and install it.</p>
<pre><code>withEnv([   &quot;VERSION=1.0.${currentBuild.number}&quot;,
            &quot;KUBECTL=kubectl&quot;,
            &quot;REGISTRY_EMAIL=brem_robert@hotmail.com&quot;]) {

  stage &quot;checkout, build, test and publish&quot;
  node {
    git url: &quot;http://disruptor.ninja:30130/rob/battleapp-frontend&quot;
    def npmHome = tool 'NPM'
    env.PATH = &quot;${npmHome}/bin:${env.PATH}&quot;
    sh &quot;npm install&quot;
    sh &quot;npm run test&quot;
    sh &quot;npm run lint&quot;
    sh &quot;npm run build:prod&quot;
    sh &quot;./build.js&quot;
    step([$class: 'JUnitResultArchiver', testResults: '**TESTS-*.xml'])
    step([$class: 'hudson.plugins.checkstyle.CheckStylePublisher', pattern: '**REPORTS-*.xml'])
  }
</code></pre>

<p>That the Karma tests can be executed on the server we've to change the
Karma settings from using Chrome to using PhantomJS. Therefore we've to change
the browser in <code>karma.conf.js</code>:</p>
<pre><code>...
browsers: [
  'PhantomJS'
],
...
</code></pre>

<p>PhantomJS is not per default installed therefore we've to install it:</p>
<pre><code>npm install --save-dev karma-phantomjs-launcher
</code></pre>

<p>That Jenkins understands the test results we've to install the 
<code>karma-junit-reporter</code>:</p>
<pre><code>npm install karma-junit-reporter --save-dev
</code></pre>

<p>And tell Angular2 to create a report. This have to be done in the
<code>karma.conf.js</code> as well:</p>
<pre><code>...
reporters: ['mocha', 'coverage', 'remap-coverage', 'junit'],

junitReporter: {
  outputDir: '', // results will be saved as $outputDir/$browserName.xml
  outputFile: undefined, // if included, results will be saved as $outputDir/$browserName/$outputFile
  suite: '', // suite will become the package name attribute in xml testsuite element
  useBrowserName: true, // add browser name to report and classes names
  nameFormatter: undefined, // function (browser, result) to customize the name attribute in xml testcase element
  classNameFormatter: undefined, // function (browser, result) to customize the classname attribute in xml testcase element
  properties: {} // key value pair of properties to add to the &lt;properties&gt; section of the report
},
...
</code></pre>

<p>That Jenkins understands the static analysis we've to adapt the <code>lint</code> 
npm script:</p>
<pre><code>&quot;lint&quot;: &quot;tslint --format tslint-checkstyle-reporter -o REPORTS-tslint.xml --force \&quot;src/**/*.ts\&quot; &amp;&amp; ./createCheckstyle.sh&quot;,
</code></pre>

<p>And install the <code>tslint-checkstyle-reporter</code>:</p>
<pre><code>npm install tslint-checkstyle-reporter --save-dev
</code></pre>

<p>Additionally we've to create a script that adds the xml header and footer for
the Checkstyle plugin. This script is created in the root folder with the
name <code>createCheckstyle.sh</code>:</p>
<pre><code># /bin/bash

sed -i &quot;1s/^/&lt;?xml version='1.0' encoding='utf-8'?&gt;\n&lt;checkstyle version='5.7'&gt;\n/&quot; REPORTS-tslint.xml
echo &quot;&lt;/checkstyle&gt;&quot; &gt;&gt; REPORTS-tslint.xml
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../02_Test_and_prod_stage/" class="btn btn-neutral float-right" title="02 Test and prod stage">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../14_Documentation_of_rest_service/01_Documentation/" class="btn btn-neutral" title="Documentation of the `jax-rs` service"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/robertBrem/Microservices_with_Kubernetes/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../../14_Documentation_of_rest_service/01_Documentation/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../02_Test_and_prod_stage/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/require.js"></script>
      <script src="../../search/search.js"></script>

</body>
</html>
